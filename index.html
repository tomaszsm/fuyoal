<html>
  <head>
    <title>Fuyoal - deniable encryption software</title>
    <meta charset="utf-8" />
    <meta name="description" content="Fuyoal - deniable encryption software home page">
  </head>
  <body>

    <h1>Fuyoal - deniable encryption software</h1>
    
    <ul>
      <li><a href="#about">About Fuyoal</a></li>
      <li><a href="#working">Working</a></li>
      <li><a href="#license">License</a></li>
      <li><a href="#kl">Known liabilities</a></li>
      <li><a href="#usage">Usage</a>
	<ul>
          <li><a href="#usagecli">Command Line Interface</a></li>
	  <li><a href="#usagegui">Graphical User Interface</a></li>
	</ul>
      </li>
      <li><a href="#download">Download</a></li>
      <li><a href="#contact">Contact</a></li>
    </ul>

    <h2><a name="about">About Fuyoal</a></h2>

    <p>In many countries <a href="https://en.wikipedia.org/wiki/Key_disclosure_law">key disclosure law</a> requires
      individuals to reveal their encryption keys to police and other law enforcement agencies. Non-compliance may
      result in serious repercussions. One way to handle this intrusion is to conceal some content in a way preventing
      any proof of its existence.</p>

    <p><a href="https://en.wikipedia.org/wiki/Deniable_encryption">Deniable encryption</a> refers to a situation when an
      adversary cannot prove that concealed content exists. The most commonly discussed form of deniable encryption
      is <a href="https://en.wikipedia.org/wiki/Steganography">steganography</a>. It is a technique fit for some
      purposes, but inadequate for general use. Firstly, because it usually takes much larger content to hide the target
      one. Secondly, because pure steganography dos not
      fulfill <a href="https://en.wikipedia.org/wiki/Kerckhoffs%27s_principle">Kerckhoffs's principle</a>.</p>

    <p>Alternative approach consist in hiding secret content along with evident albeit encrypted content. In an ideal
      situation the concealed content is hidden perfectly i.e., an adversary has no means of finding out that the secret
      part exists. However there is generally no way of decrypting one ciphertext into two sets of plain content if the
      key is shorter than the content. The strategy adopted by Fuyoal is a little different. If it is impossible to make
      single file and facade-concealed pair indistinguishable by making them look like single file, let us make them
      indistinguishable by making everything look like facade-concealed pairs. Thus Fuyoal transforms each single file
      and each facade-concealed pair of files into one encrypted file that reveals no information whether the second of
      its two volumes is real message or random blather.</p>
    
    <p>Most of versatile deniable encryption tools include low level hiding techniques like creating multiple encrypted
      disk volumes within a container volume. These tools are difficult to use in portable form or in general without
      deep integration with computer operational system. Fuyoal encrypts and decrypts selected files without any
      demanding system dependencies. It also does not leave any tracks in operational system other than the ones left by
      ordinary file manipulation.</p>

    <h2><a name="working">Working</a></h2>
    <p>Fuyoal encrypts two volumes of data (using AES-256) with two keys and concatenates them together. The encrypted
      file contains information about the size of the first volume in order make it possible to separate one of the
      volumes. The first volume is always the real file to be encrypted, the second one can be either another file or
      a block of zeros encrypted with a random key. The output file has the following structure:</p>

    <table border="1" cellpadding="5" cellspacing="0" style="border-collapse:collapse;"><tr>
	<td>Size of first volume (32 B)</td><td>IV 1 (16 B)</td><td>Key verification constant 1 (32 B)</td><td>Encrypted
	file 1</td><td>Padding 1 (1-32 B)</td><td>IV 2 (16 B)</td><td>Key verification constant 2 (32 B)</td><td>Encrypted
	file 2</td><td>Padding 2 (1-32 B)</td>
    </tr></table>
    
    <p>When decrypting, provided key is tested on the first key verification constant. If its validity is proven the key
      is used to decrypt the first volume. If the key does not fit, it is tested on the second key verification
      constant. If it appears to be valid, the second volume is decrypted. If it does not, the decryption fails.</p>
    
    <h2><a name="license">License</a></h2>

    <p>The program is available under <a href="https://opensource.org/licenses/GPL-3.0">GNU General Public License
    version 3</a>.</p>
        
    <h2><a name="kl">Known Liabilities</a></h2>

    <p>In the case of encryption of one (real) file the size of the second (phony) file is drawn from truncated normal
      distribution. The mean of the distribution equals the size of the real file, the standard deviation equals 10% of
      the size of the real file, and boundaries are set 30% of the size of the real file below and above the mean. This
      strategy should work fine when encrypting several files and when both the real and the facade files are similarly
      sized. However with a large number of files (both single ones and facade-concealed pairs), the difference between
      the distribution mentioned above and that of the sizes of the concealed files may become noticeable. This could
      give an adversary a (probabilistic) knowledge as to which encrypted files contain a hidden partition.</p>

    <p>This problem can be solved by replacing the automatic generation of the phony filesâ€™ size with a process that
      would result in indistinguishable distributions of second partitions' sizes in both groups of files. This would
      require the following steps. First, encryption of all (or a large representative sample of) facade-concealed
      pairs. Second, estimation of the distribution of the second partition's size (in relation to the size of the first
      partition). Third, encryption of the single files using explicit setup of the second partition's size (also in
      relation to the size of the first one) to mimic the previously estimated distribution. This strategy reduces chances
      of an adversary to distinguish between single and double encrypted files.</p>

    <p>Also:</p>
    <a href="https://xkcd.com/538/"><img src="https://imgs.xkcd.com/comics/security.png" /></a>
    
    <h2><a name="usage">Usage</a></h2>

    <h3><a name="usagecli">Command Line Interface</a></h3>
    
    <p>Fuyoal is to be used as follows:</p>
    <pre>
  usage: 
    fuyoal -h
    fuyoal -e FILE1 KEY1 [-s SIZE | -a FILE2 KEY2] [-o FILE]
    fuyoal -d FILE1 KEY1 [-o FILE]

  positional arguments:
    FILE1                 input file for encryption or decryption
    KEY1                  key for encryption or decryption

  optional arguments:
    -h, --help            show this help message and exit
    -e, --encrypt         encrypt FILE1 with KEY1
    -d, --decrypt         decrypt FILE1 with KEY1
    -s SIZE, --size SIZE  size of phony volume added to ane encrypted file
    -a FILE2 KEY2, --add FILE2 KEY2
			  second file, key pair for encryption
    -o FILE, --output FILE
			  write output to FILE
    </pre>

    <p>Details:</p>

    <pre>fuyoal -h</pre>
    <p>displays help message presented above.</p>

    <pre>fuyoal -e FILE1 KEY1</pre>
    <p>encrypts FILE1 with KEY1 and adds random part to make it impossible to discriminate this case from the case when
      two files are encrypted together. The size of the phony part is drawn from truncated normal distribution (see <a
      href="#kl">Known Liabilities</a> for details). The output is saved to file FILE1.fya.</p>

    <pre>fuyoal -e FILE1 KEY1 -s SIZE</pre>
    <p>encrypts FILE1 with KEY1 and adds random part to make it impossible to discriminate this case from the case when
      two files are encrypted together. The size of the phony part is specified by SIZE parameter in bytes. The output is
      saved to file FILE1.fya.</p>
    
    <pre>fuyoal -e FILE1 KEY1 -a FILE2 KEY2</pre>
    <p>encrypts FILE1 with KEY1 and FILE2 with KEY2 and saves them together to file FILE1.fya.</p>

    <pre>fuyoal -d FILE1 KEY1</pre>
    <p>depending on KEY1 either decrypts the first (when two files were encrypted together), or the only file (when just
      one file was encrypted), or decrypts the second (hidden) file (when two files were encrypted together). The input is
      encrypted FILE1.</p>

    <pre>fuyoal [-e | -d] FILE1 KEY1 [options] -o FILE</pre>
    <p>encrypts or decrypts files according to options and saves output to FILE.</p>

    <h3><a name="usagegui">Graphical User Interface</a></h3>

    <p>Using GUI version of the program is pretty self-explanatory.</p>
    
    <h2><a name="download">Download</a></h2>

    <p>Current version is 0.3.2 (beta), released 2017-09-11.</p>
    
    <table border="1" cellpadding="10" cellspacing="0" style="border-collapse:collapse;">
      <tr>
        <th>File</th>
	<th>Size</th>
	<th>SHA256</th>
      </tr>
      <tr>
        <td><a href="download/fuyoal_source.tar.gz">Source</a></td>
	<td>3.71 KB</td>
	<td>fe3dc3ee3252fb4fcdcf05ad9c7a4791a89ea2c8428094e858fc5f48063dd99a</td>
      </tr>
      <tr>
        <td><a href="download/fuyoal.exe">Windows binaries (CLI)</a></td>
	<td>3.25 MB</td>
	<td>917b52f53fbdaf22454c4afdc4aa8c6f648a84447bb379797095806f58df061c</td>
      </tr>
      <tr>
        <td><a href="download/guifuyoal.exe">Windows binaries (GUI)</a></td>
	<td>8 MB</td>
	<td>8658ad488a17671b0df60326931414e282f099100f75f2dfbf1e08e1db3804cd</td>
      </tr>
    </table>
    
    <h2><a name="contact">Contact</a></h2>

    <p>Contact the author via his <a href="http://tsmolen.eu/">web page</a>.</p>
    
    
  </body>
</html>
