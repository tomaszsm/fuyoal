<html>
  <head>
    <title>Fuyoal - deniable encryption software</title>
    <meta charset="utf-8" />
    <meta name="description" content="Fuyoal - deniable encryption software home page">
  </head>
  <body>

    <h1>Fuyoal - deniable encryption software</h1>
    
    <ul>
      <li><a href="#about">About Fuyoal</a></li>
      <li><a href="#working">Working</a></li>
      <li><a href="#licence">Licence</a></li>
      <li><a href="#kl">Known liabilities</a></li>
      <li><a href="#usage">Usage</a>
	<ul>
          <li><a href="#usagecli">Command Line Interface</a></li>
	  <li><a href="#usagegui">Graphical User Interface</a></li>
	</ul>
      </li>
      <li><a href="#download">Download</a></li>
      <li><a href="#contact">Contact</a></li>
    </ul>

    <h2><a name="about">About Fuyoal</a></h2>

    <p>In many countries <a href="https://en.wikipedia.org/wiki/Key_disclosure_law">key disclosure law</a> requires
      individuals to reveal their encryption keys to police and other law enforcement agencies. Refusal can lead to
      serious measures taken against individual. One way to avoid this constraint is to make it impossible to proof that
      the concealed content exists at all.</p>

    <p><a href="https://en.wikipedia.org/wiki/Deniable_encryption">Deniable encryption</a> refers to a situation when
      adversary can not prove that concealed content exists. Most commonly discussed form of deniable encryption
      is <a href="https://en.wikipedia.org/wiki/Steganography">steganography</a>. This technique fits for some uses but
      is not adequate for general purposes. Firstly because it usually takes much larger content to hide the target
      one. Secondly because plain steganography dos not
      fulfill <a href="https://en.wikipedia.org/wiki/Kerckhoffs%27s_principle">Kerckhoffs's principle</a>.</p>

    <p>Alternative approach include hiding secret content in along with evident albeit encrypted content. In an ideal
      situation the concealed content is hidden perfectly i.e., adversary has no means of finding if the secret part
      exists. However In general case there is no way of decrypting one ciphertext to two plain contents if the key is
      shorter than the content. Thus the strategy adopted by Fuyoal is a little different. If an individual can not make
      single file and facade-concealed pair indistinguishable by making them look like single file let us make them
      indistinguishable by making them all look like facade-concealed pairs. Thus Fuyoal transform both single file or
      facade-concealed pair of iles into one encrypted file that reval no information if the second file is real message
      or random blather.</p>
    
    <p>Most of versatile deniable encryption tools include low level hiding techniques like creating multiple encrypted
      disk volumes within a container volume. These tools are difficult to use in portable form or in general without
      deep integration with computer operational system. Fuyoal encrypts and decrypts selected files without any
      demanding system dependencies. It also does not leave any tracks in operational system other than the ones leaved
      by ordinary file manipulation.</p>

    <h2><a name="working">Working</a></h2>
    <p>Fuyoal encrypts two volumes of data with two keys and concatenate them together. Encrypted file contains size of
      first volume in order make it possible to separate one of the volumes. First volume is always encrypted file,
      second one can be either another file or block of "0" characters encrypted with random key. Encrypted file has
      following structure:</p>

    <table border="1" cellpadding="5" cellspacing="0" style="border-collapse:collapse;"><tr>
	<td>Size of first volume (32 B)</td><td>IV 1 (16 B)</td><td>Key verification constant 1 (32 B)</td><td>Encrypted
	file 1</td><td>Padding 1 (1-32 B)</td><td>IV 2 (16 B)</td><td>Key verification constant 2 (32 B)</td><td>Encrypted
	file 2</td><td>Padding 2 (1-32 B)</td>
    </tr></table>
    
    <p>When decrypting, provided key is tested on first key verification constant. If its validity is proven the key is
    used to decrypt first volume. If the key does not fit it is tested on second key verification constant. If it appear
    to be valid the second volume is decrypted. If it does not the decryption fails.</p>
    
    <h2><a name="licence">Licence</a></h2>

    <p>The program is available under <a href="https://opensource.org/licenses/GPL-3.0">GNU General Public License
    version 3</a>.</p>
        
    <h2><a name="kl">Known Liabilities</a></h2>

    <p>In case of encryption of one file the size of the second (phony) file is drawn from truncated normal
      distribution. The mean of the distribution equals the size of the real file, the standard deviation equals 10% of
      the size of the real file, and boundaries are set 30% of the size of the real file below and above mean. This
      strategy should work fine when a few files is encrypted and when hidden files have size close to facade
      files. However when large number of files is encrypted (both single files and facade-concealed pairs) the
      difference between the above said distribution and distribution of sizes of concealed files may became
      noticeable. This could give adversary (probabilistic) knowledge of which encrypted files contain hidden
      partition.</p>

    <p>Solution to the problem is replacing automatic generation of size of phony files with process that would result
      in indistinguishable distributions of sizes of second partitions in both groups of files. This would require
      following steps. First, all (or large representative sample) facade-concealed pairs need to be encrypted. Second,
      the distribution of size of second partition (in relation to the size of first partition) need to be
      estimated. Third, the single files need to be encrypted using explicit setup of second partition size (also in
      relation to the size of first partition) to mimic the previously estimated distribution. This strategy reduces
      chance of adversary to distinguish between single and double encrypted files.</p>

    <p>Also:</p>
    <a href="https://xkcd.com/538/"><img src="https://imgs.xkcd.com/comics/security.png" /></a>
    
    <h2><a name="usage">Usage</a></h2>

    <h3><a name="usagecli">Command Line Interface</a></h3>
    
    <p>Fuyoal is to be used as follows:</p>
    <pre>
    Usage:
      fuyoal -h
      fuyoal -e file1 key1 [-s size] | [file2 key2]
      fuyoal -d file key1 | key2
    
    Options:
      -h        Shows help message
      -e        Ensrypts file1 with key1 and possibly file2 with key2
      -s        Specify size of phony second file (in bytes)
      -d        Decrypts file with key
    </pre>

    <p>Details:</p>

    <pre>fuyoal -h</pre>
    <p>displays help message presented above.</p>

    <pre>fuyoal -e file1 key1</pre>
    <p>encrypts <i>file1</i> with <i>key1</i> and adds random part to make it impossible to discriminate this case from
      case when two files are encrypted together. The size of the phony part is drawn from truncated normal distribution
      (see <a href="#kl">Known Liabilities</a> for details). The output is saved to file <i>file1</i>.fya.</p>

    <pre>fuyoal -e file1 key1 -s size</pre>
    <p>encrypts <i>file1</i> with <i>key1</i> and adds random part to make it impossible to discriminate this case from
      case when two files are encrypted together. The size of the phony part is specified by <i>size</i> parameter in
      bytes. The output is saved to file <i>file1</i>.fya.</p>
    
    <pre>fuyoal -e file1 key1 file2 key2</pre>
    <p>encrypts <i>file1</i> with <i>key1</i> and <i>file2</i> with <i>key2</i>. The output is saved to
      file <i>file1</i>.fya.</p>

    <pre>fuyoal -d file key1</pre>
    <p>decrypts first (when two files were encrypted together) or only file (when just one file was encrypted).</p>

    <pre>fuyoal -d file key2</pre>
    <p>decrypts second (hidden) file (when two files were encrypted together).</p>

    <h3><a name="usagegui">Graphical User Interface</a></h3>

    <p>Using GUI version of the program is pretty self explanatory.</p>
    
    <h2><a name="download">Download</a></h2>

    <table border="1" cellpadding="10" cellspacing="0" style="border-collapse:collapse;">
      <tr>
        <th>File</th>
	<th>Version</th>
	<th>SHA256</th>
      </tr>
      <tr>
        <td><a href="download/fuyoal_source.tar.gz">Source</a></td>
	<td>0.2.1 (alpha)</td>
	<td>67cfc1ed859a8e7525b5348807c26188c110b681c569ee6a881337cb32502b48</td>
      </tr>
      <tr>
        <td><a href="download/fuyoal.exe">Windows binaries (CLI)</a></td>
	<td>0.2.1 (alpha)</td>
	<td>c76775f20fecfd40265b83c5a8b5788325fbda82a5073f2bb6ee4cbd6a697b29</td>
      </tr>
      <tr>
        <td><a href="download/guifuyoal.exe">Windows binaries (GUI)</a></td>
	<td>0.2.1 (alpha)</td>
	<td>eb627bb35110b95d9ba8aae5cb6af9c97738bab9a1f943b5f5961d5305bf1444</td>
      </tr>
    </table>
    
    <h2><a name="contact">Contact</a></h2>

    <p>Contact the author via his <a href="http://tsmolen.eu/">web page</a>.</p>
    
    
  </body>
</html>
